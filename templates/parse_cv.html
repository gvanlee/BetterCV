{% extends "base.html" %}

{% block title %}{{ t.cv_parsing.title }} - {{ t.app_name }}{% endblock %}

{% block content %}
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
        <div class="loading-spinner"></div>
        <div class="loading-text">{{ t.cv_parsing.processing }}</div>
        <div class="loading-subtext">{{ t.cv_parsing.processing_note }}</div>
    </div>
</div>

<div class="page-header">
    <h2>{{ t.cv_parsing.title }}</h2>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">{{ t.cv_parsing.back_button }}</a>
</div>

<div class="info-section">
    <h3>{{ t.cv_parsing.how_it_works }}</h3>
    <p>{{ t.cv_parsing.description }}</p>
    <ul>
        <li>{{ t.cv_parsing.step_1 }}</li>
        <li>{{ t.cv_parsing.step_2 }}</li>
        <li>{{ t.cv_parsing.step_3 }}</li>
        <li>{{ t.cv_parsing.step_4 }}</li>
    </ul>
</div>

<form method="POST" action="{{ url_for('parse_cv') }}" enctype="multipart/form-data" class="form" id="parseForm">
    <div class="form-section">
        <h3>{{ t.cv_parsing.upload_title }}</h3>
        
        <div class="form-row">
            <div class="form-group">
                <label for="ai_provider">{{ t.cv_parsing.ai_model_label }}</label>
                <select id="ai_provider" name="ai_provider">
                    <option value="gemini">Google Gemini (Flash 1.5/2.0)</option>
                    <option value="groq" {% if not has_groq %}disabled{% endif %}>Groq (Llama 3.3 70B)</option>
                </select>
                <small class="form-hint">{{ t.cv_parsing.ai_model_hint }}</small>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="cv_file">{{ t.cv_parsing.file_label }} *</label>
                <input type="file" id="cv_file" name="cv_file" accept=".pdf,.docx,.doc,.txt" required>
                <small class="form-hint">{{ t.cv_parsing.file_hint }}</small>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="consultant_name">{{ t.cv_parsing.name_label }}</label>
                <input type="text" id="consultant_name" name="consultant_name" placeholder="{{ t.cv_parsing.name_placeholder }}">
                <small class="form-hint">{{ t.cv_parsing.name_hint }}</small>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary" id="submitBtn">{{ t.cv_parsing.parse_button }}</button>
            <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">{{ t.buttons.cancel }}</a>
        </div>
    </div>
</form>

<div class="info-section">
    <h3>{{ t.cv_parsing.requirements_title }}</h3>
    <ul>
        <li>{{ t.cv_parsing.requirement_1 }}</li>
        <li>{{ t.cv_parsing.requirement_2 }}</li>
        <li>{{ t.cv_parsing.requirement_3 }}</li>
    </ul>
    
    <div class="alert alert-info">
        <strong>{{ t.cv_parsing.privacy_title }}:</strong> {{ t.cv_parsing.privacy_note }}
    </div>
</div>

<script>
    document.getElementById('parseForm').addEventListener('submit', function(e) {
        // Show loading overlay
        document.getElementById('loadingOverlay').classList.add('active');
        // Disable submit button to prevent double submission
        document.getElementById('submitBtn').disabled = true;
    });
</script>
{% endblock %}